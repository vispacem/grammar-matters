
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1 Loading the weather data &#8212;   documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="1-Loading-the-weather-data">
<h1>1 Loading the weather data<a class="headerlink" href="#1-Loading-the-weather-data" title="Permalink to this headline">¶</a></h1>
<p>You have learned some more about Python and the pandas module and tried it out on a fairly small dataset. You are now ready to explore a dataset from the Weather Underground.</p>
<p><img alt="An image of filter like diagonal strips across various skies such as an orange sunset, a storm and a clear blue sky" src="../../_images/ou_futurelearn_learn_to_code_fig_10391.jpg" /></p>
<p><strong>Figure 1</strong></p>
<p>Open the file London_2014.csv and save it in the disk folder or CoCalc project you created in Week 1.</p>
<p><strong>Do not be tempted to open this file with Excel</strong> as this application will attempt to localise the data in the file, i.e. use your country’s local data formats, which will make much of what follows rather incomprehensible! You can if you like open the file with a simple text editor, but <strong>do not make any changes</strong>.</p>
<p>The CSV file can be loaded into a dataframe by executing the following code:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>from pandas import *
london = read_csv(&#39;London_2014.csv&#39;)
london.head()
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><img alt="First 5 rows of the london dataframe. Note that only the first few columns are shown due to the limitation of page width." src="../../_images/ou_futurelearn_learn_to_code_fig_1006.jpg" /></p>
<p><strong>Figure 2</strong></p>
<ul class="simple">
<li><p>Note that the right hand side of the table has been cropped to fit on the page. *</p></li>
</ul>
<p>In the next section, you’ll find out how to remove rogue spaces.</p>
<hr class="docutils" />
<div class="section" id="Important-notice-for-learners-outside-of-the-EU">
<h2>Important notice for learners outside of the EU<a class="headerlink" href="#Important-notice-for-learners-outside-of-the-EU" title="Permalink to this headline">¶</a></h2>
<p>The Weather Underground automatically localises data based on from what country it detects you are accessing the web site. So, for example, if you are accessing the website from the USA wind speeds will be in MPH rather than km/h and temperatures in Fahrenheit rather than Celsius.</p>
<p>In order to change the settings so that the data is in European format you will need to click on the ‘head and shoulders’ icon on the top right of the Weather Underground web page and create a free Weather Underground account.</p>
<p>Once you have created an account, click on the ‘cog’ icon on the top right of the web page. Then:</p>
<ul class="simple">
<li><p>click on the C button to select Celsius</p></li>
<li><p>click on ‘More Settings’ and select Units: metric</p></li>
<li><p>click on ‘Save My Preferences’.</p></li>
</ul>
<p>Now, when you download the data, temperatures will be in Celsius and wind speeds in km/h etc.</p>
<hr class="docutils" />
<div class="section" id="1.1-Removing-rogue-spaces">
<h3>1.1 Removing rogue spaces<a class="headerlink" href="#1.1-Removing-rogue-spaces" title="Permalink to this headline">¶</a></h3>
<p>One of the problems often encountered with CSV files is rogue spaces before or after data values or column names.</p>
<p><img alt="An image of empty, numbered parking spaces" src="../../_images/ou_futurelearn_learn_to_code_fig_1045.jpg" /></p>
<p><strong>Figure 3</strong></p>
<p>You learned earlier, in What is a CSV file? , that each value or column name is separated by a comma. However, if you opened ‘London_2014.csv’ in a text editor, you would see that in the row of column names sometimes there are spaces after a comma:</p>
<!--Quote id=--><blockquote>
<div><p>GMT,Max TemperatureC,Mean TemperatureC,Min TemperatureC,Dew PointC,MeanDew PointC,Min DewpointC,Max Humidity, Mean Humidity, Min Humidity, Max Sea Level PressurehPa, Mean Sea Level PressurehPa, Min Sea Level PressurehPa, Max VisibilityKm, Mean VisibilityKm, Min VisibilitykM, Max Wind SpeedKm/h, Mean Wind SpeedKm/h, Max Gust SpeedKm/h,Precipitationmm, CloudCover, Events,WindDirDegrees</p>
</div></blockquote>
<p>For example, there is a space after the comma between <code class="docutils literal notranslate"><span class="pre">Max</span> <span class="pre">Humidity</span></code> and <code class="docutils literal notranslate"><span class="pre">Mean</span> <span class="pre">Humidity</span></code>. This means that when <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> reads the row of column names it will interpret a space after a comma as part of the next column name. So, for example, the column name after <code class="docutils literal notranslate"><span class="pre">'Max</span> <span class="pre">Humidity'</span></code> will be interpreted as <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">Mean</span> <span class="pre">Humidity'</span></code> rather than what was intended, which is <code class="docutils literal notranslate"><span class="pre">'Mean</span> <span class="pre">Humidity'</span></code>. The ramification of this is that code such as:</p>
<p><code class="docutils literal notranslate"><span class="pre">london[['Mean</span> <span class="pre">Humidity']]</span></code></p>
<p>will cause a key error (see Selecting a column ), as the column name is confusingly <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">Mean</span> <span class="pre">Humidity</span></code> ’.</p>
<p>This can easily be rectified by adding another argument to the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function:</p>
<p><code class="docutils literal notranslate"><span class="pre">skipinitialspace=True</span></code></p>
<p>which will tell <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> to ignore any spaces after a comma:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>


<span></span>london = read_csv(&#39;London_2014.csv&#39;, skipinitialspace=True)

</pre></div>
</div>
</div>
<p>The rogue spaces will no longer be in the dataframe and we can write code such as:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[['Mean</span> <span class="pre">Humidity']].head()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings"><caption></caption><tbody><tr><th></th><th><p><strong>Mean Humidity</strong></p>
</th></tr><tr><td class="highlight_" rowspan colspan><p>0</p>
</td><td class="highlight_" rowspan colspan><p>86</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>1</p>
</td><td class="highlight_" rowspan colspan><p>81</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>2</p>
</td><td class="highlight_" rowspan colspan><p>76</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>3</p>
</td><td class="highlight_" rowspan colspan><p>85</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>4</p>
</td><td class="highlight_" rowspan colspan><p>88</p>
</td></tr></tbody></table><p>Note that a <code class="docutils literal notranslate"><span class="pre">skipinitialspace=True</span></code> argument won’t remove a trailing space at the end of a column name.</p>
<p>Next, find out about extra characters and how to remove them.</p>
</div>
<div class="section" id="1.2-Removing-extra-characters">
<h3>1.2 Removing extra characters<a class="headerlink" href="#1.2-Removing-extra-characters" title="Permalink to this headline">¶</a></h3>
<p>If you opened London_2014.csv in a text editor once again and looked at the last column name you would see that the name is’WindDirDegrees</p>
<p>’.</p>
<p>What has happened here is that when the dataset was exported from the Weather Underground website an html line break <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">)</span></code> was added after the line of column headers which <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> has interpreted as the end part of the final column’s name.</p>
<p><img alt="An image of two bouncers in suits standing in a corridor" src="../../_images/ou_futurelearn_learn_to_code_fig_1050.jpg" /></p>
<p><strong>Figure 4</strong></p>
<p>In fact, the problem is worse than this, let’s look at some values in the final column:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[['WindDirDegrees</span> <span class="pre">']].head()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings"><caption></caption><tbody><tr><th></th><th><p>__ WindDirDegrees __</p>
</th></tr><tr><td class="highlight_" rowspan colspan><p>0</p>
</td><td class="highlight_" rowspan colspan><p>186</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>1</p>
</td><td class="highlight_" rowspan colspan><p>214</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>2</p>
</td><td class="highlight_" rowspan colspan><p>219</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>3</p>
</td><td class="highlight_" rowspan colspan><p>211</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>4</p>
</td><td class="highlight_" rowspan colspan><p>199</p>
</td></tr></tbody></table><p>It’s seems there is an html line break at the end of each line. If I opened ‘London_2014.csv’ in a text editor and looked at the ends of all lines in the file this would be confirmed.</p>
<p>Once again I’m not going to edit the CSV file but rather fix the problem in the dataframe. To change <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees</span> <span class="pre">'</span></code> to <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> all I have to do is use the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> method as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london</span> <span class="pre">=</span> <span class="pre">london.rename(columns={'WindDirDegrees</span> <span class="pre">':'WindDirDegrees'})</span></code></p>
<p>Don’t worry about the syntax of the argument for <code class="docutils literal notranslate"><span class="pre">rename()</span></code> , just use this example as a template for whenever you need to change the name of a column.</p>
<p>Now I need to get rid of those pesky <a href="#id1"><span class="problematic" id="id2">``</span></a>`` html line breaks from the ends of the values in the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column, so that they become something sensible. I can do that using the string method <code class="docutils literal notranslate"><span class="pre">rstrip()</span></code> which is used to remove characters from the end or ‘rear’ of a string, just like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london['WindDirDegrees']</span> <span class="pre">=</span> <span class="pre">london['WindDirDegrees'].str.rstrip('</span> <span class="pre">')</span></code></p>
<p>Again don’t worry too much about the syntax of the code and simply use it as a template for whenever you need to process a whole column of values stripping characters from the end of each string value.</p>
<p>Let’s display the first few rows of the ’ <code class="docutils literal notranslate"><span class="pre">WindDirDegrees</span></code> ’ to confirm the changes:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[['WindDirDegrees']].head()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<table xmlns:str="http://exslt.org/strings"><caption></caption><tbody><tr><th></th><th><p><strong>WindDirDegrees</strong></p>
</th></tr><tr><td class="highlight_" rowspan colspan><p>0</p>
</td><td class="highlight_" rowspan colspan><p>186</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>1</p>
</td><td class="highlight_" rowspan colspan><p>214</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>2</p>
</td><td class="highlight_" rowspan colspan><p>219</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>3</p>
</td><td class="highlight_" rowspan colspan><p>211</p>
</td></tr><tr><td class="highlight_" rowspan colspan><p>4</p>
</td><td class="highlight_" rowspan colspan><p>199</p>
</td></tr></tbody></table></div>
<div class="section" id="1.3-Missing-values">
<h3>1.3 Missing values<a class="headerlink" href="#1.3-Missing-values" title="Permalink to this headline">¶</a></h3>
<p>As you heard in the video at the start of the week, missing values (also called null values) are one of the reasons to clean data.</p>
<p><img alt="An image of a girl with the last piece of a jigsaw puzzle" src="../../_images/ou_futurelearn_learn_to_code_fig_1051.jpg" /></p>
<p><strong>Figure 5</strong></p>
<p>Finding missing values in a particular column can be done with the column method <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> , like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london['Events'].isnull()</span></code></p>
<p>The above code returns a series of Boolean values, where <code class="docutils literal notranslate"><span class="pre">True</span></code> indicates that the corresponding row in the <code class="docutils literal notranslate"><span class="pre">'Events'</span></code> column is missing a value and <code class="docutils literal notranslate"><span class="pre">False</span></code> indicates the presence of a value. Here are the last few rows from the series:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>...
360 False
361 True
362 True
363 True
364 False
Name: Events, dtype: bool
</pre></div>
</div>
</div>
<p>If, as you did with the comparison expressions, you put this code within square brackets after the dataframe’s name, it will return a new dataframe consisting of all the rows without recorded events (rain, fog, thunderstorm, etc.):</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[london['Events'].isnull()]</span></code></p>
<p>As you will see in Exercise 4 of the exercise notebook, this will return a new dataframe with 114 rows, showing that more than one in three days had no particular event recorded. If you scroll the table to the right, you will see that all values in the <code class="docutils literal notranslate"><span class="pre">'Events'</span></code> column are marked <code class="docutils literal notranslate"><span class="pre">NaN</span></code> , which stands for ‘Not a Number’, but is also used to mark non-numeric missing values, like in this case (events are strings, not numbers).</p>
<p>Once you know how much and where data is missing, you have to decide what to do: ignore those rows? Replace with a fixed value? Replace with a computed value, like the mean?</p>
<p>In this case, only the first two options are possible. The method call <code class="docutils literal notranslate"><span class="pre">london.dropna()</span></code> will drop (remove) all rows that have a missing (non-available) value somewhere, returning a new dataframe. This will therefore also remove rows that have missing values in other columns.</p>
<p>The column method <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> will replace all non-available values with the value given as argument. For this case, each NaN could be replaced by the empty string.</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>london[&#39;Events&#39;] = london[&#39;Events&#39;].fillna(&#39;&#39;)
ondon[london[&#39;Events&#39;].isnull()]
</pre></div>
</div>
</div>
<p>The second line above will now show an empty dataframe, because there are no longer missing values in the events column.</p>
<p>As a final note on missing values, pandas ignores them when computing numeric statistics, i.e. you don’t have to remove missing values before applying <code class="docutils literal notranslate"><span class="pre">sum(),</span> <span class="pre">median()</span></code> and other similar methods.</p>
<p>Learn about checking data types of each column in the next section.</p>
</div>
<div class="section" id="1.4-Changing-the-value-types-of-columns">
<h3>1.4 Changing the value types of columns<a class="headerlink" href="#1.4-Changing-the-value-types-of-columns" title="Permalink to this headline">¶</a></h3>
<p>The function <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> may, for many reasons, wrongly interpret the data type of the values in a column, so when cleaning data it’s important to check the data types of each column are what is expected, and if necessary change them.</p>
<p>The data type of every column in a dataframe can be determined by looking at the dataframe’s <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> attribute, like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london.dtypes</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>GMT object
Max TemperatureC int64
Mean TemperatureC int64
Min TemperatureC int64
Dew PointC int64
MeanDew PointC int64
Min DewpointC int64
Max Humidity int64
Mean Humidity int64
Min Humidity int64
Max Sea Level PressurehPa int64
Mean Sea Level PressurehPa int64
Min Sea Level PressurehPa int64
Max VisibilityKm int64
Mean VisibilityKm int64
Min VisibilitykM int64
Max Wind SpeedKm/h int64
Mean Wind SpeedKm/h int64
Max Gust SpeedKm/h float64
Precipitationmm float64
CloudCover float64
Events object
WindDirDegrees object
dtype: object
</pre></div>
</div>
</div>
<p>In the above output, you can see the column names to the left and to the right the data types of the values in those columns.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int64</span></code> is the pandas data type for whole numbers such as <code class="docutils literal notranslate"><span class="pre">55</span></code> or <code class="docutils literal notranslate"><span class="pre">2356</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code> is the pandas data type for decimal numbers such as <code class="docutils literal notranslate"><span class="pre">55.25</span></code> or <code class="docutils literal notranslate"><span class="pre">2356.00</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> is the pandas data type for strings such as <code class="docutils literal notranslate"><span class="pre">'hello</span> <span class="pre">world'</span></code> or <code class="docutils literal notranslate"><span class="pre">'rain'</span></code></p></li>
</ul>
<p>Most of the column data types seem fine, however two are of concern, <code class="docutils literal notranslate"><span class="pre">'GMT'</span></code> and <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> , both of which are of type <code class="docutils literal notranslate"><span class="pre">object.</span></code> Let’s take a look at <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> first.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Changing-the-data-type-of-the-‘WindDirDegrees’-column">
<h2>Changing the data type of the ‘WindDirDegrees’ column<a class="headerlink" href="#Changing-the-data-type-of-the-‘WindDirDegrees’-column" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> method has interpreted the values in the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column as strings (type <code class="docutils literal notranslate"><span class="pre">object</span></code> ). This is because in the CSV file the values in that column had all been suffixed with that html line break string <a href="#id3"><span class="problematic" id="id4">``</span></a>`` so <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> had no alternative but to interpret the values as strings.</p>
<p>The values in the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column are meant to represent wind direction in terms of degrees from true north (360) and meteorologists always define the wind direction as the direction the wind is coming from. So if you stand so that the wind is blowing directly into your face, the direction you are facing names the wind, so a westerly wind is reported as 270 degrees. The compass rose shown below should make this clearer:</p>
<p><img alt="figure images/ou_futurelearn_learn_to_code_fig_1007.jpg" src="../../_images/ou_futurelearn_learn_to_code_fig_1007.jpg" /></p>
<p><strong>Figure 6</strong> A compass rose</p>
<p>We need to be able to make queries such as ‘Get and display the rows where the wind direction is greater than 350 degrees’. To do this we need to change the data type of the ‘WindDirDegrees’ column from object to type <code class="docutils literal notranslate"><span class="pre">int64</span></code>. We can do that by using the <code class="docutils literal notranslate"><span class="pre">astype()</span></code> method like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london['WindDirDegrees']</span> <span class="pre">=</span> <span class="pre">london['WindDirDegrees'].astype('int64')</span></code></p>
<p>Now all the values in the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column are of type <code class="docutils literal notranslate"><span class="pre">int64</span></code> and we can make our query:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[london['WindDirDegrees']</span> <span class="pre">&amp;gt;</span> <span class="pre">350]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><img alt="Rows from the london dataframe where the value in the WindDirDegrees column is greater than 350. Note that the WindDirDegrees column is not shown as it is on the far right of the table and only the first few columns are shown due to the limitation of page width." src="../../_images/ou_futurelearn_learn_to_code_fig_1008.jpg" /></p>
<p><strong>Figure 7</strong></p>
<ul class="simple">
<li><p>Note that the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column is on the far right of the table and the right of the table has been cropped to fit on the page. *</p></li>
</ul>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="Changing-the-data-type-of-the-‘GMT’-column">
<h2>Changing the data type of the ‘GMT’ column<a class="headerlink" href="#Changing-the-data-type-of-the-‘GMT’-column" title="Permalink to this headline">¶</a></h2>
<p>Recall that I noted that the <code class="docutils literal notranslate"><span class="pre">'GMT'</span></code> column was of type <code class="docutils literal notranslate"><span class="pre">object</span></code> , the type pandas uses for strings.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'GMT'</span></code> column is supposed to represent dates. It would be helpful for the date values not to be strings to make it possible to make queries of the data such as ‘Return the row where the date is 4 June 2014’.</p>
<p>Pandas has a function called <code class="docutils literal notranslate"><span class="pre">to_datetime()</span></code> which can convert a column of <code class="docutils literal notranslate"><span class="pre">object</span></code> (string) values such as those in the <code class="docutils literal notranslate"><span class="pre">'GMT'</span></code> column into values of a proper date type called `<code class="docutils literal notranslate"><span class="pre">datetime64</span></code> , ` just like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>london[&#39;GMT&#39;] = to_datetime(london[&#39;GMT&#39;])

#Then display the types of all the columns again so we

#can check the changes have been made.
london.dtypes
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>GMT datetime64[ns]
Max TemperatureC int64
Mean TemperatureC int64
Min TemperatureC int64
Dew PointC int64
MeanDew PointC int64
Min DewpointC int64
Max Humidity int64
Mean Humidity int64
Min Humidity int64
Max Sea Level PressurehPa int64
Mean Sea Level PressurehPa int64
Min Sea Level PressurehPa int64
Max VisibilityKm int64
Mean VisibilityKm int64
Min VisibilitykM int64
Max Wind SpeedKm/h int64
Mean Wind SpeedKm/h int64
Max Gust SpeedKm/h float64
Precipitationmm float64
CloudCover float64
Events object
WindDirDegrees int64
dtype: object
</pre></div>
</div>
</div>
<p>From the above output, we can confirm that the <code class="docutils literal notranslate"><span class="pre">'WindDirDegrees'</span></code> column type has been changed from <code class="docutils literal notranslate"><span class="pre">object</span></code> to <code class="docutils literal notranslate"><span class="pre">int64</span></code> and that the <code class="docutils literal notranslate"><span class="pre">'GMT'</span></code> column type has been changed from <code class="docutils literal notranslate"><span class="pre">object</span></code> to <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>.</p>
<p>To make queries such as ‘Return the row where the date is 4 June 2014’ you’ll need to be able to create a <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> value to represent June 4 2014. It cannot be:</p>
<p><code class="docutils literal notranslate"><span class="pre">london[london['GMT']</span> <span class="pre">==</span> <span class="pre">'2014-1-3']</span></code></p>
<p>because ‘2014-1-3’ is a string and the values in the ‘GMT’ column are of type <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>. Instead you must create a <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> value using <code class="docutils literal notranslate"><span class="pre">thedatetime()</span></code> function like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">datetime(2014,</span> <span class="pre">6,</span> <span class="pre">4)</span></code></p>
<p>In the function call above, the first integer argument is the year, the second the month and the third the day.</p>
<p>Let’s try the function out by executing the code to ‘Return the row where the date is 4 June 2014’:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">london[london['GMT']</span> <span class="pre">==</span> <span class="pre">datetime(2014,</span> <span class="pre">6,</span> <span class="pre">4)]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><img alt="The row from the london dataframe where the date is 4 June 2014. Note that only the first few columns are shown due to the limitation of page width." src="../../_images/ou_futurelearn_learn_to_code_fig_1009.jpg" /></p>
<p><strong>Figure 8</strong></p>
<ul class="simple">
<li><p>Note that the right side of the table has been cropped to fit on the page. *</p></li>
</ul>
<p>You can also now make more complex queries involving dates such as ‘Return all the rows where the date is between 8 December 2014 and 12 December 2014’, like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[]:</span></code></p>
<p>c</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>london[(london[&#39;GMT&#39;] &gt;= datetime(2014, 12, 8))
    &amp; (london[&#39;GMT&#39;] &lt;= datetime(2014, 12, 12))]
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Out[]:</span></code></p>
<p><img alt="The rows from the london dataframe where the date is between 8 December 2014 and 12 December 2014 (inclusive). Note that only the first few columns are shown due to the limitation of page width." src="../../_images/ou_futurelearn_learn_to_code_fig_1010.jpg" /></p>
<p><strong>Figure 9</strong></p>
<p><em>Note that the right side of the table has been cropped to fit on the page.</em></p>
</div>
<div class="section" id="Exercise-4-Display-rows-from-dataframe">
<h2>Exercise 4 Display rows from dataframe<a class="headerlink" href="#Exercise-4-Display-rows-from-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Now try Exercise 4 in the Exercise notebook 2.</p>
<p>If you’re using Anaconda instead of CoCalc, remember that to open the notebook you’ll need to navigate to the notebook using Jupyter.</p>
<p>Once the notebook is open, run the existing code in the notebook before you start the exercise. When you’ve completed the exercise, save the notebook. If you need a quick reminder of how to use Jupyter, watch again the video in Week 1 Exercise 1.</p>
<hr class="docutils" />
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html"></a></h1>



<p class="blurb">Documentation...</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_01.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_02.html">1 Install the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_03.html">2 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_01/Part_01_04.html">3 Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_01.html">1 Enter the pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_02.html">2 Writing up the analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_03.html">3 This week’s quiz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session_02/Part_02_04.html">4 Summary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/content/session_04/Part_04_01.md"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>